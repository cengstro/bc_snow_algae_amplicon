---
title: "Cellct analysis"
output: html_notebook
---

```{r, include=F}
library(tidyverse)
library(here)
```

```{r, include=F}
cellct <- read_csv(here("data/02_tidied/tidied.cell_count.csv"))
field <- read_csv(here("data/02_tidied/tidied_field.csv"))
rel_abund <- read_csv(here("data/03_filtered/rbcl/filtered_cleaned_rbcl_rel_abund.csv"))
```

```{r heatmap, echo=F, fig.height=10, fig.width=6}
p <- cellct %>% 
  left_join(field, by="sample_id")

morpho_order <- c("Green cell",
                  "Sanguina 'citrine'",
                  "Sanguina nivaloides",
                  "Sanguina nivaloides 'ruby'",
                  "Green cell",
                  "Chlainomonas",
                  "Chloromonas krienitzii",
                  "Chloromonas cf. brevispina",
                  "Chloromonas cf. nivalis",
                  "Chloromonas 'spiny'",
                  "Chloromonas 'oval'",
                  "Chloromonas 'zuke'"
                  )

my_theme <- theme(axis.text.x = element_text(hjust=1,angle=45))

ggplot(p, aes(y=alias %>% fct_reorder(elev_m), 
              x=morpho_sp)) +
  geom_tile(aes(alpha = percent_of_sample, fill = morpho_sp)) + # color = "white" %>% fct_reorder(morpho_order)
  labs(x="Cell morphology", y= "Sample ID", fill = "Cell morphology", alpha="Relative abundance") +
  guides(fill=F) +
  scale_alpha(range = c(0.1, 1)) +
  my_theme
```

